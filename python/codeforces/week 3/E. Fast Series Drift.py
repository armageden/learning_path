def _f_(_x_,_y_,_p_):
    _z_=[[0,0],[0,0]]
    _z_[0][0]=(_x_[0][0]*_y_[0][0]+_x_[0][1]*_y_[1][0])%_p_
    _z_[0][1]=(_x_[0][0]*_y_[0][1]+_x_[0][1]*_y_[1][1])%_p_
    _z_[1][0]=(_x_[1][0]*_y_[0][0]+_x_[1][1]*_y_[1][0])%_p_
    _z_[1][1]=(_x_[1][0]*_y_[0][1]+_x_[1][1]*_y_[1][1])%_p_
    return _z_
def _g_(_mat_,_e_,_p_):
    _r_=[[1,0],[0,1]]
    _b_=_mat_
    while _e_>0:
        if _e_%2==1:
            _r_=_f_(_r_,_b_,_p_)
        _b_=_f_(_b_,_b_,_p_)
        _e_//=2
    return _r_
_t_=int(input())
for _i_ in range(_t_):
    _a_,_n_,_m_=map(int,input().split())
    if _a_==1:
        print(_n_%_m_)
        continue
    _t_mat_=[[_a_%_m_,0],[_a_%_m_,1]]
    _t_res_=_g_(_t_mat_,_n_,_m_)
    print(_t_res_[1][0])